%%%% -------------------------------------------------------------------
%%% Author  : Masahiko KAGAWA
%%% Description :
%%%
%%% Created : 2010/05/21
%%% -------------------------------------------------------------------
-module(cruisectl).

%% --------------------------------------------------------------------
%% Include files
%% --------------------------------------------------------------------

%% --------------------------------------------------------------------
%% External exports
%% --------------------------------------------------------------------
-export([start/0]).

%% --------------------------------------------------------------------
%% Macros
%% --------------------------------------------------------------------

%% --------------------------------------------------------------------
%% Records
%% --------------------------------------------------------------------

%% ====================================================================
%% External functions
%% ====================================================================
start() ->
	SelfPid = self(),
	process_flag(trap_exit, true),
	Pid =  spawn_link(fun() -> cruisectl_gui:start(SelfPid) end),

	put(child_gui, Pid),
	event_loop().

%% ====================================================================
%% Internal functions
%% ====================================================================
event_loop() ->
	receive
		{state_inf, chgui, CruiseSpeed} ->
			io:format("in cruisectl~n"),
			gen_server:cast({global,dcs},{state_inf, cruisespeed, CruiseSpeed});
		{'EXIT', _Pid, normal} ->
			bye;
		{'EXIT', Pid, Why} ->
			io:format("child process[~p] terminated : ~p~n", [Pid, Why]),
			exit(error);
		_Any ->
			io:format("loadenv unknown type received : ~p~n", [_Any]),
			event_loop()
	end.

%% ====================================================================
%% Intra functions
%% ====================================================================
calDynFrictional(Sta)->
	Sta * 2/ 3.

